{"ast":null,"code":"import { DecodeStream } from './DecodeStream.js';\nconst textEncoder = new TextEncoder();\nconst isBigEndian = new Uint8Array(new Uint16Array([0x1234]).buffer)[0] == 0x12;\nexport class EncodeStream {\n  constructor(buffer) {\n    this.buffer = buffer;\n    this.view = new DataView(this.buffer.buffer, this.buffer.byteOffset, this.buffer.byteLength);\n    this.pos = 0;\n  }\n  writeBuffer(buffer) {\n    this.buffer.set(buffer, this.pos);\n    this.pos += buffer.length;\n  }\n  writeString(string) {\n    let encoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'ascii';\n    let buf;\n    switch (encoding) {\n      case 'utf16le':\n      case 'utf16-le':\n      case 'ucs2':\n        // node treats this the same as utf16.\n        buf = stringToUtf16(string, isBigEndian);\n        break;\n      case 'utf16be':\n      case 'utf16-be':\n        buf = stringToUtf16(string, !isBigEndian);\n        break;\n      case 'utf8':\n        buf = textEncoder.encode(string);\n        break;\n      case 'ascii':\n        buf = stringToAscii(string);\n        break;\n      default:\n        throw new Error(`Unsupported encoding: ${encoding}`);\n    }\n    this.writeBuffer(buf);\n  }\n  writeUInt24BE(val) {\n    this.buffer[this.pos++] = val >>> 16 & 0xff;\n    this.buffer[this.pos++] = val >>> 8 & 0xff;\n    this.buffer[this.pos++] = val & 0xff;\n  }\n  writeUInt24LE(val) {\n    this.buffer[this.pos++] = val & 0xff;\n    this.buffer[this.pos++] = val >>> 8 & 0xff;\n    this.buffer[this.pos++] = val >>> 16 & 0xff;\n  }\n  writeInt24BE(val) {\n    if (val >= 0) {\n      this.writeUInt24BE(val);\n    } else {\n      this.writeUInt24BE(val + 0xffffff + 1);\n    }\n  }\n  writeInt24LE(val) {\n    if (val >= 0) {\n      this.writeUInt24LE(val);\n    } else {\n      this.writeUInt24LE(val + 0xffffff + 1);\n    }\n  }\n  fill(val, length) {\n    if (length < this.buffer.length) {\n      this.buffer.fill(val, this.pos, this.pos + length);\n      this.pos += length;\n    } else {\n      const buf = new Uint8Array(length);\n      buf.fill(val);\n      this.writeBuffer(buf);\n    }\n  }\n}\nfunction stringToUtf16(string, swap) {\n  let buf = new Uint16Array(string.length);\n  for (let i = 0; i < string.length; i++) {\n    let code = string.charCodeAt(i);\n    if (swap) {\n      code = code >> 8 | (code & 0xff) << 8;\n    }\n    buf[i] = code;\n  }\n  return new Uint8Array(buf.buffer);\n}\nfunction stringToAscii(string) {\n  let buf = new Uint8Array(string.length);\n  for (let i = 0; i < string.length; i++) {\n    // Match node.js behavior - encoding allows 8-bit rather than 7-bit.\n    buf[i] = string.charCodeAt(i);\n  }\n  return buf;\n}\nfor (let key of Object.getOwnPropertyNames(DataView.prototype)) {\n  if (key.slice(0, 3) === 'set') {\n    let type = key.slice(3).replace('Ui', 'UI');\n    if (type === 'Float32') {\n      type = 'Float';\n    } else if (type === 'Float64') {\n      type = 'Double';\n    }\n    let bytes = DecodeStream.TYPES[type];\n    EncodeStream.prototype['write' + type + (bytes === 1 ? '' : 'BE')] = function (value) {\n      this.view[key](this.pos, value, false);\n      this.pos += bytes;\n    };\n    if (bytes !== 1) {\n      EncodeStream.prototype['write' + type + 'LE'] = function (value) {\n        this.view[key](this.pos, value, true);\n        this.pos += bytes;\n      };\n    }\n  }\n}","map":{"version":3,"names":["DecodeStream","textEncoder","TextEncoder","isBigEndian","Uint8Array","Uint16Array","buffer","EncodeStream","constructor","view","DataView","byteOffset","byteLength","pos","writeBuffer","set","length","writeString","string","encoding","arguments","undefined","buf","stringToUtf16","encode","stringToAscii","Error","writeUInt24BE","val","writeUInt24LE","writeInt24BE","writeInt24LE","fill","swap","i","code","charCodeAt","key","Object","getOwnPropertyNames","prototype","slice","type","replace","bytes","TYPES","value"],"sources":["/Users/tomertal/Development/code/portfolio-site/node_modules/restructure/src/EncodeStream.js"],"sourcesContent":["import {DecodeStream} from './DecodeStream.js';\n\nconst textEncoder = new TextEncoder();\nconst isBigEndian = new Uint8Array(new Uint16Array([0x1234]).buffer)[0] == 0x12;\n\nexport class EncodeStream {\n  constructor(buffer) {\n    this.buffer = buffer;\n    this.view = new DataView(this.buffer.buffer, this.buffer.byteOffset, this.buffer.byteLength);\n    this.pos = 0;\n  }\n\n  writeBuffer(buffer) {\n    this.buffer.set(buffer, this.pos);\n    this.pos += buffer.length;\n  }\n\n  writeString(string, encoding = 'ascii') {\n    let buf;\n    switch (encoding) {\n      case 'utf16le':\n      case 'utf16-le':\n      case 'ucs2': // node treats this the same as utf16.\n        buf = stringToUtf16(string, isBigEndian);\n        break;\n\n      case 'utf16be':\n      case 'utf16-be':\n        buf = stringToUtf16(string, !isBigEndian);\n        break;\n\n      case 'utf8':\n        buf = textEncoder.encode(string);\n        break;\n\n      case 'ascii':\n        buf = stringToAscii(string);\n        break;\n\n      default:\n        throw new Error(`Unsupported encoding: ${encoding}`);\n    }\n\n    this.writeBuffer(buf);\n  }\n\n  writeUInt24BE(val) {\n    this.buffer[this.pos++] = (val >>> 16) & 0xff;\n    this.buffer[this.pos++] = (val >>> 8) & 0xff;\n    this.buffer[this.pos++] = val & 0xff;\n  }\n\n  writeUInt24LE(val) {\n    this.buffer[this.pos++] = val & 0xff;\n    this.buffer[this.pos++] = (val >>> 8) & 0xff;\n    this.buffer[this.pos++] = (val >>> 16) & 0xff;\n  }\n\n  writeInt24BE(val) {\n    if (val >= 0) {\n      this.writeUInt24BE(val);\n    } else {\n      this.writeUInt24BE(val + 0xffffff + 1);\n    }\n  }\n\n  writeInt24LE(val) {\n    if (val >= 0) {\n      this.writeUInt24LE(val);\n    } else {\n      this.writeUInt24LE(val + 0xffffff + 1);\n    }\n  }\n\n  fill(val, length) {\n    if (length < this.buffer.length) {\n      this.buffer.fill(val, this.pos, this.pos + length);\n      this.pos += length;\n    } else {\n      const buf = new Uint8Array(length);\n      buf.fill(val);\n      this.writeBuffer(buf);\n    }\n  }\n}\n\nfunction stringToUtf16(string, swap) {\n  let buf = new Uint16Array(string.length);\n  for (let i = 0; i < string.length; i++) {\n    let code = string.charCodeAt(i);\n    if (swap) {\n      code = (code >> 8) | ((code & 0xff) << 8);\n    }\n    buf[i] = code;\n  }\n  return new Uint8Array(buf.buffer);\n}\n\nfunction stringToAscii(string) {\n  let buf = new Uint8Array(string.length);\n  for (let i = 0; i < string.length; i++) {\n    // Match node.js behavior - encoding allows 8-bit rather than 7-bit.\n    buf[i] = string.charCodeAt(i);\n  }\n  return buf;\n}\n\nfor (let key of Object.getOwnPropertyNames(DataView.prototype)) {\n  if (key.slice(0, 3) === 'set') {\n    let type = key.slice(3).replace('Ui', 'UI');\n    if (type === 'Float32') {\n      type = 'Float';\n    } else if (type === 'Float64') {\n      type = 'Double';\n    }\n    let bytes = DecodeStream.TYPES[type];\n    EncodeStream.prototype['write' + type + (bytes === 1 ? '' : 'BE')] = function (value) {\n      this.view[key](this.pos, value, false);\n      this.pos += bytes;\n    };\n\n    if (bytes !== 1) {\n      EncodeStream.prototype['write' + type + 'LE'] = function (value) {\n        this.view[key](this.pos, value, true);\n        this.pos += bytes;\n      };\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}